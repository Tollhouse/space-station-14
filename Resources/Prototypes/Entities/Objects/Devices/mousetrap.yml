- type: entity
  name: mousetrap
  parent: BaseItem
  id: Mousetrap
  description: Useful for catching rodents sneaking into your kitchen.
  components:
    - type: Sprite
      sprite: Objects/Devices/mousetrap.rsi
      drawdepth: SmallMobs # if mice can hide under tables, so can mousetraps
      layers:
        - state: mousetrap
          map: ["base"]
    - type: StepTrigger
      intersectRatio: 0.2
      requiredTriggeredSpeed: 0
    - type: Mousetrap
    - type: TriggerOnStepTrigger
    - type: ShoesRequiredStepTrigger
    - type: DamageUserOnTrigger
      damage:
        types:
          Blunt: 2 # base damage, scales based on mass
    - type: EmitSoundOnUse
      sound: "/Audio/Items/Handcuffs/cuff_end.ogg"
    - type: EmitSoundOnTrigger
      sound: "/Audio/Items/snap.ogg"
    - type: Item
      sprite: Objects/Devices/mousetrap.rsi
    - type: Appearance
    - type: GenericVisualizer
      visuals:
        enum.MousetrapVisuals.Visual:
          base:
            Armed: { state: mousetraparmed }
            Unarmed: { state: mousetrap }
    - type: Physics
      bodyType: Dynamic
    - type: CollisionWake
      enabled: false
    - type: Fixtures
      fixtures:
        slips:
          shape:
            !type:PhysShapeAabb
            bounds: "-0.2,-0.2,0.2,0.2"
          hard: false
          layer:
            - LowImpassable
        fix1:
          shape:
            !type:PhysShapeAabb
            bounds: "-0.2,-0.2,0.2,0.2"
          density: 30
          mask:
            - ItemMask
    - type: Rotatable
    - type: Tag
      tags:
        - DroneUsable

- type: entity
  name: mousetrap
  suffix: Armed
  parent: Mousetrap
  id: MousetrapArmed
  description: Useful for catching rodents sneaking into your kitchen.
  components:
    - type: Mousetrap
      isActive: true
    
- type: entity
  name: loadablemousetrap
  parent: BaseItem
  id: Mousetrap
  description: Useful for catching larger rodents sneaking about.
  components:
    - type: Sprite
      sprite: Objects/Devices/mousetrap.rsi
      drawdepth: SmallMobs # if mice can hide under tables, so can mousetraps
      layers:
        - state: mousetrap
          map: ["base"]
    - type: StepTrigger
      intersectRatio: 0.2
      requiredTriggeredSpeed: 0
  - type: Gun
    fireRate: 2
    selectedMode: SemiAuto
    availableModes:
    - SemiAuto
    soundGunshot:
      path: /Audio/Weapons/Guns/Gunshots/shotgun.ogg
    soundEmpty:
      path: /Audio/Weapons/Guns/Empty/empty.ogg
  - type: BallisticAmmoProvider
    whitelist:
      tags:
      - ShellShotgun
    capacity: 1
    proto: ShellShotgun
    soundInsert:
      path: /Audio/Weapons/Guns/MagIn/shotgun_insert.ogg
  - type: ContainerContainer
    containers:
      ballistic-ammo: !type:Container
        ents: []
    - type: Mousetrap
    - type: TriggerOnStepTrigger
    - type: ShoesRequiredStepTrigger
    - type: DamageUserOnTrigger
      damage:
        types:
          Blunt: 2 # base damage, scales based on mass
    - type: EmitSoundOnUse
      sound: "/Audio/Items/Handcuffs/cuff_end.ogg"
    - type: EmitSoundOnTrigger
      sound: "/Audio/Items/snap.ogg"
    - type: Item
      sprite: Objects/Devices/mousetrap.rsi
    - type: Appearance
    - type: GenericVisualizer
      visuals:
        enum.MousetrapVisuals.Visual:
          base:
            Armed: { state: loadedmousetraparmed }
            Unarmed: { state: loadablemousetrap }
    - type: Physics
      bodyType: Dynamic
    - type: CollisionWake
      enabled: false
    - type: Fixtures
      fixtures:
        slips:
          shape:
            !type:PhysShapeAabb
            bounds: "-0.2,-0.2,0.2,0.2"
          hard: false
          layer:
            - LowImpassable
        fix1:
          shape:
            !type:PhysShapeAabb
            bounds: "-0.2,-0.2,0.2,0.2"
          density: 30
          mask:
            - ItemMask
    - type: Rotatable
    - type: Tag
      tags:
        - DroneUsable

- type: entity
  name: loadedmousetraparmed
  suffix: Armed
  parent: loadableMousetrap
  id: loadedmousetraparmed
  description: Useful for catching rodents sneaking into your kitchen.
  components:
    - type: Mousetrap
      isActive: true